<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Sheets IDE</title>
    <style>
      body {
        font-family: 'Google Sans', Arial, sans-serif;
        margin: 0;
        padding: 16px;
        background-color: #f8f9fa;
      }
      .container {
        max-width: 100%;
      }
      .header {
        text-align: center;
        margin-bottom: 20px;
      }
      .logo {
        font-size: 24px;
        margin-bottom: 8px;
      }
      .subtitle {
        color: #666;
        font-size: 14px;
        margin: 0;
      }
      .chat-container {
        background: white;
        border-radius: 8px;
        padding: 16px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        min-height: 400px;
        display: flex;
        flex-direction: column;
      }
      .messages {
        flex: 1;
        overflow-y: auto;
        margin-bottom: 16px;
        max-height: 350px;
      }
      .message {
        margin-bottom: 12px;
        padding: 12px;
        border-radius: 8px;
        line-height: 1.4;
      }
      .user-message {
        background-color: #e3f2fd;
        text-align: right;
        margin-left: 20px;
      }
      .ai-message {
        background-color: #f5f5f5;
        margin-right: 20px;
      }
      .input-container {
        display: flex;
        gap: 8px;
        align-items: center;
      }
      input[type="text"] {
        flex: 1;
        padding: 12px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 14px;
      }
      input[type="text"]:focus {
        outline: none;
        border-color: #1976d2;
        box-shadow: 0 0 0 2px rgba(25, 118, 210, 0.2);
      }
      .send-button {
        padding: 12px 16px;
        background-color: #1976d2;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
      }
      .send-button:hover {
        background-color: #1565c0;
      }
      .send-button:disabled {
        background-color: #ccc;
        cursor: not-allowed;
      }
      .status {
        text-align: center;
        padding: 8px;
        font-size: 12px;
        color: #666;
      }
      .examples {
        margin-top: 16px;
      }
      .example-button {
        display: block;
        width: 100%;
        padding: 8px 12px;
        margin-bottom: 8px;
        background: #f8f9fa;
        border: 1px solid #e0e0e0;
        border-radius: 4px;
        cursor: pointer;
        font-size: 13px;
        text-align: left;
      }
      .example-button:hover {
        background: #e8f0fe;
        border-color: #1976d2;
      }
      .loading {
        display: none;
        text-align: center;
        padding: 16px;
      }
      .spinner {
        border: 2px solid #f3f3f3;
        border-top: 2px solid #1976d2;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        animation: spin 1s linear infinite;
        margin: 0 auto 8px;
      }
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="logo">ü§ñ Sheets IDE</div>
        <p class="subtitle">AI-powered Google Sheets automation</p>
      </div>
      
      <div class="chat-container">
        <div class="messages" id="messages">
          <div class="message ai-message">
            üëã Hello! I'm your Sheets IDE assistant. I can help you automate Google Sheets tasks through natural language commands.
            <br><br>
            <strong>Try asking me to:</strong>
            <ul style="margin: 8px 0; padding-left: 20px;">
              <li>"Create a new sheet called 'Sales Data'"</li>
              <li>"Add sample data to the current sheet"</li>
              <li>"Format the header row as bold"</li>
              <li>"Insert a SUM formula in cell D10"</li>
            </ul>
          </div>
        </div>
        
        <div class="loading" id="loading">
          <div class="spinner"></div>
          <div>Processing your request...</div>
        </div>
        
        <div class="input-container">
          <input type="text" id="userInput" placeholder="Ask me to help with your spreadsheet..." />
          <button class="send-button" id="sendButton" onclick="sendMessage()">Send</button>
        </div>
        
        <div class="status" id="status">
          Ready to help! Type a command above.
        </div>
      </div>
      
      <div class="examples">
        <button class="example-button" onclick="useExample('Create a new sheet called Sales Data')">
          üìä Create a new sheet called "Sales Data"
        </button>
        <button class="example-button" onclick="useExample('Add headers: Date, Product, Quantity, Revenue')">
          üìù Add headers: Date, Product, Quantity, Revenue
        </button>
        <button class="example-button" onclick="useExample('Make the first row bold and add borders')">
          üé® Make the first row bold and add borders
        </button>
        <button class="example-button" onclick="useExample('Insert a SUM formula to calculate total revenue')">
          üßÆ Insert a SUM formula to calculate total revenue
        </button>
      </div>
    </div>

    <script>
      let isProcessing = false;
      
      function sendMessage() {
        const input = document.getElementById('userInput');
        const message = input.value.trim();
        
        if (message && !isProcessing) {
          addMessage(message, 'user');
          input.value = '';
          processMessage(message);
        }
      }
      
      function useExample(exampleText) {
        document.getElementById('userInput').value = exampleText;
        sendMessage();
      }
      
      function addMessage(text, sender) {
        const messagesDiv = document.getElementById('messages');
        const messageDiv = document.createElement('div');
        messageDiv.className = 'message ' + (sender === 'user' ? 'user-message' : 'ai-message');
        messageDiv.innerHTML = text;
        messagesDiv.appendChild(messageDiv);
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
      }
      
      function showLoading(show) {
        const loading = document.getElementById('loading');
        const sendButton = document.getElementById('sendButton');
        const status = document.getElementById('status');
        
        loading.style.display = show ? 'block' : 'none';
        sendButton.disabled = show;
        isProcessing = show;
        
        if (show) {
          status.textContent = 'Processing your request...';
        } else {
          status.textContent = 'Ready to help! Type a command above.';
        }
      }
      
      function processMessage(message) {
        showLoading(true);
        
        // Simulate AI processing (will be replaced with actual AI integration)
        setTimeout(() => {
          let response = '';
          
          if (message.toLowerCase().includes('create') && message.toLowerCase().includes('sheet')) {
            response = '‚úÖ I understand you want to create a new sheet. In the full implementation, I would:\n\n1. Create a new sheet with the specified name\n2. Set up any requested headers or structure\n3. Apply basic formatting\n\nThis feature is coming soon!';
          } else if (message.toLowerCase().includes('format') || message.toLowerCase().includes('bold')) {
            response = 'üé® I can help with formatting! In the full implementation, I would:\n\n1. Select the specified range\n2. Apply the requested formatting (bold, colors, borders)\n3. Show you a preview before applying\n\nThis feature is coming soon!';
          } else if (message.toLowerCase().includes('formula') || message.toLowerCase().includes('sum')) {
            response = 'üßÆ I can help with formulas! In the full implementation, I would:\n\n1. Analyze your data structure\n2. Insert the appropriate formula\n3. Verify the calculation is correct\n\nThis feature is coming soon!';
          } else {
            response = `üí° I understand you want to: "${message}"\n\nIn the full Sheets IDE implementation, I would analyze your request, break it down into steps, and execute the appropriate Google Sheets operations automatically.\n\nThis is currently a preview - the full AI integration is coming soon!`;
          }
          
          addMessage(response, 'ai');
          showLoading(false);
        }, 1500);
      }
      
      // Allow Enter key to send message
      document.getElementById('userInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter' && !isProcessing) {
          sendMessage();
        }
      });
      
      // Auto-focus input
      document.getElementById('userInput').focus();
    </script>
  </body>
</html>